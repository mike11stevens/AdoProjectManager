@model AdoProjectManager.Models.ProjectCloneRequest

@{
    ViewData["Title"] = "Configure Project Clone";
    var sourceProject = ViewBag.SourceProject as AdoProjectManager.Models.AdoProject;
}

<div class="container mt-4">
    <div class="row">
        <div class="col-md-12">
            <h2><i class="fas fa-cog"></i> Configure Project Clone</h2>
            <p class="lead">Configure options for cloning project: <strong>@sourceProject?.Name</strong></p>

            @if (sourceProject != null)
            {
                <div class="alert alert-info mb-4">
                    <h6><i class="fas fa-info-circle"></i> Source Project Details</h6>
                    <ul class="mb-0">
                        <li><strong>Name:</strong> @sourceProject.Name</li>
                        <li><strong>Description:</strong> @(string.IsNullOrEmpty(sourceProject.Description) ? "No description" : sourceProject.Description)</li>
                        <li><strong>State:</strong> @sourceProject.State</li>
                        <li><strong>Last Updated:</strong> @sourceProject.LastUpdateTime.ToString("MMM dd, yyyy")</li>
                    </ul>
                </div>
            }

            <form asp-action="StartClone" method="post">
                @Html.AntiForgeryToken()
                <input type="hidden" asp-for="SourceProjectId" />

                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0">Target Project Information</h5>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label asp-for="TargetProjectName" class="form-label">
                                <i class="fas fa-project-diagram"></i> New Project Name *
                            </label>
                            <input asp-for="TargetProjectName" class="form-control" placeholder="Enter the name for the new project" required />
                            <span asp-validation-for="TargetProjectName" class="text-danger"></span>
                        </div>

                        <div class="form-group">
                            <label asp-for="TargetProjectDescription" class="form-label">
                                <i class="fas fa-file-alt"></i> Project Description
                            </label>
                            <textarea asp-for="TargetProjectDescription" class="form-control" rows="3" 
                                      placeholder="Enter a description for the new project (optional)"></textarea>
                            <span asp-validation-for="TargetProjectDescription" class="text-danger"></span>
                        </div>

                        <div class="alert alert-info">
                            <i class="fas fa-info-circle"></i>
                            <strong>Note:</strong> Projects will be cloned within the current Azure DevOps organization (@Model.TargetOrganizationUrl) for security and consistency.
                        </div>
                    </div>
                </div>



                <div class="card mb-4">
                    <div class="card-header bg-warning">
                        <h5 class="mb-0"><i class="fas fa-exclamation-triangle"></i> Important Notes</h5>
                    </div>
                    <div class="card-body">
                        <ul class="mb-0">
                            <li><strong>Cloning Process:</strong> The project clone will include Git repositories, build pipelines, work items, dashboards, and wiki content</li>
                            <li><strong>Security Settings:</strong> The new project will use default Azure DevOps security settings - teams, groups, and permissions are not copied for security and clean setup</li>
                            <li><strong>Permissions Required:</strong> You must have project creation permissions in the Azure DevOps organization</li>
                            <li><strong>Processing Time:</strong> Large projects with many repositories and work items may take several minutes to clone</li>
                            <li><strong>Project Template:</strong> The target project will use the default process template available in your organization</li>
                            <li><strong>Content Preservation:</strong> All cloned content maintains its original structure and relationships where possible</li>
                        </ul>
                    </div>
                </div>

                <div class="form-group">
                    <button type="submit" class="btn btn-primary btn-lg">
                        <i class="fas fa-play"></i> Start Project Clone
                    </button>
                    <a href="@Url.Action("Index")" class="btn btn-secondary btn-lg">
                        <i class="fas fa-times"></i> Cancel
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    
    <script>
        $(document).ready(function() {
            // Form validation and UI enhancements can be added here
            console.log('Configure Project Clone page loaded');
        });
    </script>
}
